<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1, maximum-scale=1, user-scalable=no, width=device-width">
</head>

<body>
<!-- 	<input type="file" id = "up_image"> -->
<!-- 	<h1>Click the button to create a File Upload Button.</h1>

	<button onclick="myFunction()">Upload Pic</button> -->
<input onclick="back()" type="button" class="submit" value="â—„" style="height: 50px; width: 100px; color: green;">
<center><h1 id="cats" style="color: Blue">Categoty_Type</h1></center>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
<form id="form1" runat="server">
  <h1>Image</h1>
  <input type="text" name="img_name" placeholder="Image Name">
  
  <input type='file' id="imgInp" name="image" src="#" />
  <h1>Audio</h1>
  <input type='file' id="audInp" name="audio" src="#" />
  <img id="blah" src="#" alt="your image" style="height: 20%; width: 20%" />
  <p id="get_src"></p>
</form>
<center><input onclick="uploadImage()" type="button" class="submit" value="Upload" style="height: 50px; width: 100px; color: green;"></center>

<script>
  $("#cats").html(localStorage.getItem('Cat_type'));
function readURL(input) {


  if (input.files && input.files[0]) {
    var reader = new FileReader();

    reader.onload = function(e) {
      $('#blah').attr('src', e.target.result);
      var img_source =document.getElementById("imgInp").getAttribute('src');
      document.getElementById('get_src').innerHTML = img_source;
      // var img_source =document.getElementById("blah").getAttribute('src');
      // document.getElementById('get_src').innerHTML = img_source;
      
    }

    reader.readAsDataURL(input.files[0]);
  }
}


$("#imgInp").change(function() {
  readURL(this);
});
</script>


<script>
  function formCreate(acc_id,img_name, img_type, filetype1, fileVal1,filetype2,fileVal2){
      var form = new FormData();
      form.append('acc_id', acc_id);
      form.append('img_name', img_name);
      form.append('img_type', img_type);
      form.append('type1',filetype1);
      form.append('image', fileVal1);
      form.append('type2',filetype2);
      form.append('aud', fileVal2);
      

      return form;
  }

  function back(){
    var cat_type = localStorage.getItem('Cat_type');
    if(cat_type == "Places"){
      location = "places.html";
    }else if(cat_type == "Clothes"){
      location = "clothes.html";
    }else if(cat_type == "Toys"){
      location = "toys.html";
    }else if(cat_type == "Food"){
      location = "food.html";
    }
  }

  function uploadImage(){
    var acc_id = localStorage.getItem('acc_id');
    var cat_type = localStorage.getItem('Cat_type');
    
    $.ajax({
      type: 'POST',
          url: 'https://cryptic-fjord-60133.herokuapp.com/api/v3/upload',
          data: formCreate(acc_id, $('input[name="img_name"]').val(),cat_type,'image', $('input[name="image"]')[0].files[0],'audio', $('input[name="audio"]')[0].files[0]),
          cache: false,
          contentType: false,
          processData: false,
          async: false,
          success: function(response) {
            if(response.msg=='ok'){
              alert("successfully uploaded "+cat_type+" Category")
              if(cat_type == "Places"){
                location = "places.html";
              }else if(cat_type == "Clothes"){
                location = "clothes.html";
              }else if(cat_type == "Toys"){
                location = "toys.html";
              }else if(cat_type == "Food"){
                location = "food.html";
              }
              
            }
            else{
              console.log(response.msg);
              alert(response.msg);
            }
          },
  });

}
</script>

</body>
</html>
